<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Litecor</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg1:#071227; --bg2:#082033;
  --accent1:#00bcd4; --accent2:#6a00ff;
  --muted: rgba(234,252,255,0.72);
  --glass: rgba(255,255,255,0.04);
  --orange: #ff8800;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;color:#eafcff;background:linear-gradient(120deg,var(--bg1) 0%,var(--bg2) 100%);-webkit-font-smoothing:antialiased;scroll-behavior:auto}
/* hide default scrollbar but keep scroll functionality */
html { scrollbar-width: none; -ms-overflow-style: none; }
html::-webkit-scrollbar { display: none; }

/* background layers */
.bg-wrap{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden}
.bg-gradient{position:absolute;inset:-20%;background:linear-gradient(45deg,#061426,#082b3a,#08132a);filter:blur(30px);opacity:0.95;animation:gradShift 20s linear infinite}
@keyframes gradShift{0%{transform:translateX(-6%)}50%{transform:translateX(6%)}100%{transform:translateX(-6%)}}
.orb{position:absolute;border-radius:50%;filter:blur(40px);opacity:0.6;mix-blend-mode:screen;will-change:transform}
.orb.o1{width:420px;height:420px;background:radial-gradient(circle,var(--accent1) 0%,transparent 45%);left:-8%;top:10%;animation:orbMove1 28s linear infinite}
.orb.o2{width:360px;height:360px;background:radial-gradient(circle,var(--accent2) 0%,transparent 45%);right:-6%;top:30%;animation:orbMove2 24s linear infinite}
.orb.o3{width:300px;height:300px;background:radial-gradient(circle,#3ddc97 0%,transparent 45%);left:20%;bottom:-6%;animation:orbMove3 32s linear infinite}
@keyframes orbMove1{0%{transform:translateY(0)}50%{transform:translateY(18px)}100%{transform:translateY(0)}}
@keyframes orbMove2{0%{transform:translateY(0)}50%{transform:translateY(-28px)}100%{transform:translateY(0)}}
@keyframes orbMove3{0%{transform:translateY(0)}50%{transform:translateY(12px)}100%{transform:translateY(0)}}

/* top nav */
header{position:fixed;left:0;right:0;top:14px;height:64px;display:flex;align-items:center;justify-content:center;padding:0 18px;z-index:60;pointer-events:auto}
.nav-inner{width:min(1200px,calc(100% - 40px));display:flex;align-items:center;justify-content:space-between}
.logo-wrap{display:flex;align-items:center;gap:12px}
.logo-vid{width:64px;height:64px;border-radius:12px;overflow:hidden;box-shadow:0 8px 28px rgba(0,0,0,0.6);cursor:pointer;flex:0 0 64px}
.logo-vid video{width:100%;height:100%;object-fit:cover;display:block}

/* site title color-shift animation */
.site-title{font-weight:700;letter-spacing:.2px;position:relative;display:inline-block;padding:4px 6px}
.site-title.color-shift{animation:colorShift 4s linear infinite}
@keyframes colorShift{
  0%{color:var(--accent1); text-shadow: 0 6px 20px rgba(0,188,212,0.12)}
  25%{color:var(--accent2); text-shadow: 0 6px 24px rgba(106,0,255,0.12)}
  50%{color:#3ddc97; text-shadow: 0 6px 20px rgba(61,220,151,0.12)}
  75%{color:var(--orange); text-shadow: 0 6px 20px rgba(255,136,0,0.10)}
  100%{color:var(--accent1); text-shadow: 0 6px 20px rgba(0,188,212,0.12)}
}

nav{display:flex;gap:12px;align-items:center}
nav a{color:rgba(234,252,255,0.92);text-decoration:none;padding:8px 12px;border-radius:10px;font-weight:600;background:transparent;border:1px solid transparent;transition:all .22s}
nav a:hover{transform:translateY(-3px);background:rgba(255,255,255,0.02);border-color:rgba(255,255,255,0.03)}

/* audio control (moved left from extreme right) */
.audio-control{position:fixed;top:18px;right:84px;z-index:75;display:flex;align-items:center;gap:8px;pointer-events:auto}
.audio-btn{width:44px;height:44px;border-radius:10px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.05);display:flex;align-items:center;justify-content:center;cursor:pointer}
.audio-panel{position:fixed;top:72px;right:84px;background:rgba(0,0,0,0.55);backdrop-filter:blur(8px);padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,0.06);display:none;flex-direction:column;gap:8px;width:220px}
.audio-panel.show{display:flex}

/* custom styling for the range so it reaches the ends and we can visually fill it */
input[type="range"]{
  -webkit-appearance:none;
  width:100%;
  height:10px;
  border-radius:999px;
  background: transparent; /* handled by JS */
  cursor:pointer;
  margin:6px 0;
  outline:none;
}
input[type="range"]::-webkit-slider-runnable-track{height:10px;border-radius:999px;background:transparent}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:linear-gradient(90deg,var(--accent1),var(--accent2));box-shadow:0 6px 14px rgba(0,0,0,0.45);margin-top:-3px}
input[type="range"]::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:linear-gradient(90deg,var(--accent1),var(--accent2));box-shadow:0 6px 14px rgba(0,0,0,0.45);}

/* main layout */
main{position:relative;z-index:20}
section{min-height:100vh;padding:120px 20px;display:flex;align-items:center;justify-content:center}
.container{width:min(1100px,94%);margin:0 auto}

/* hero */
.hero{display:flex;flex-direction:column;align-items:center;gap:18px;text-align:center}
.hero h1{font-size:clamp(28px,4.6vw,56px);margin:0;color:var(--accent1);line-height:1.02}
.hero p{max-width:820px;color:var(--muted);margin:0;font-size:1.05rem}
.card-zone{position:relative;width:860px;height:480px;display:flex;align-items:center;justify-content:center;pointer-events:none}
.card-interact{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:820px;height:440px;border-radius:22px;pointer-events:auto;display:flex;align-items:center;justify-content:center}
.center-card{width:720px;height:360px;border-radius:18px;background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.06);backdrop-filter:blur(12px) saturate(120%);box-shadow:0 40px 120px rgba(3,6,23,0.7);display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:28px;transition:transform .12s ease,box-shadow .12s;cursor:pointer;position:relative;overflow:visible}
.center-card h2{margin:0;font-size:1.8rem;color:var(--accent2)}
.center-card p{margin-top:8px;color:var(--muted)}
.card-shadow{position:absolute;width:560px;height:360px;border-radius:20px;background:radial-gradient(ellipse at center, rgba(0,60,90,0.16), rgba(0,0,0,0));filter:blur(36px);z-index:-1;transition:transform .12s}

/* ripple */
.ripple{position:fixed;border-radius:50%;transform:translate(-50%,-50%) scale(0);pointer-events:none;z-index:95;mix-blend-mode:screen;}

/* small timeline scrub visual (editor easter egg) - now reaches 100% */
.timeline-scrub{position:absolute;left:50%;transform:translateX(-50%);bottom:22px;width:60%;height:8px;border-radius:8px;background:rgba(0,0,0,0.25);border:1px solid rgba(255,255,255,0.03);overflow:hidden;display:none;pointer-events:none;z-index:50}
.timeline-bar{height:100%;width:0;background:linear-gradient(90deg,var(--accent1),var(--accent2));transition:width 1.2s cubic-bezier(.2,.9,.2,1)}

/* portfolio */
.portfolio{width:100%}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:26px;align-items:start}
@media(max-width:940px){.grid{grid-template-columns:1fr}}
.vid-card{border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.04);background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));box-shadow:0 18px 40px rgba(0,0,0,0.5)}
.vid-card iframe{width:100%;height:420px;border:0}
@media(max-width:1020px){.vid-card iframe{height:320px}}

/* contact */
form{display:flex;flex-direction:column;gap:12px;max-width:520px;margin-top:10px}
label{font-size:0.84rem;color:var(--muted);font-weight:600}
.input-row{display:flex;flex-direction:column;gap:6px}
input,textarea,button{border-radius:10px;padding:12px;border:1px solid rgba(255,255,255,0.06);background:rgba(255,255,255,0.02);color:#eafcff;font-size:0.98rem;outline:none}
button{cursor:pointer;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#012;font-weight:700;border:none;transition:transform .12s}
button:active{transform:translateY(2px)}

/* right-side dots only (no scroll bar) */
.right-ui{position:fixed;right:56px;top:50%;transform:translateY(-50%);display:flex;flex-direction:column;gap:14px;align-items:center;z-index:70;pointer-events:auto}
.dot{width:12px;height:12px;border-radius:999px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.06);cursor:pointer;transition:transform .28s,background .28s,box-shadow .28s;animation:float 3.8s ease-in-out infinite}
@keyframes float{0%{transform:translateY(0) }50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
.dot:nth-child(2){animation-delay:0.2s}
.dot:nth-child(3){animation-delay:0.45s}
.dot.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));box-shadow:0 10px 30px rgba(0,0,0,0.5);transform:scale(1.15)}

/* small reveal animations */
.reveal{opacity:0;transform:translateY(8px);transition:opacity .6s ease, transform .6s ease}
.reveal.in{opacity:1;transform:none}

/* bottom messages */
.bottom-note{position:fixed;left:50%;transform:translateX(-50%) translateY(12px);bottom:20px;background:rgba(0,0,0,0.5);padding:10px 14px;border-radius:10px;color:#eafcff;z-index:80;opacity:0;transition:opacity .18s,transform .28s}

/* cursor trail dots container */
.cursor-trail{position:fixed;left:0;top:0;pointer-events:none;z-index:90}

/* small utilities */
.muted{opacity:0.84;color:var(--muted)}
@media(max-width:720px){header{top:8px}.logo-vid{width:52px;height:52px}.card-zone{width:92%;height:360px}.center-card{width:92%;height:auto;padding:20px}.audio-panel{right:12px;width:84vw}}
</style>
</head>
<body>

<!-- background -->
<div class="bg-wrap" aria-hidden>
  <div class="bg-gradient"></div>
  <div class="orb o1"></div>
  <div class="orb o2"></div>
  <div class="orb o3"></div>
</div>

<header>
  <div class="nav-inner">
    <div class="logo-wrap">
      <div class="logo-vid" id="logoBtn" title="Litecor">
        <!-- NOTE: if your uploaded file expired, re-upload or change the src -->
        <video id="logoVideo" src="/mnt/data/chrollo.mp4" autoplay muted loop playsinline></video>
      </div>
      <div class="site-title color-shift" id="siteTitle">Litecor</div>
    </div>

    <nav id="topNav" aria-label="Primary">
      <a href="#home" data-target="home">Home</a>
      <a href="#portfolio" data-target="portfolio">Portfolio</a>
      <a href="#contact" data-target="contact">Contact</a>
    </nav>
  </div>
</header>

<!-- audio control (moved left) -->
<div class="audio-control" aria-hidden>
  <div class="audio-btn" id="audioBtn" title="Audio controls" aria-haspopup="true" aria-expanded="false">
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#eafcff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"></path><path d="M19 9a5 5 0 0 1 0 6"></path></svg>
  </div>
  <div class="audio-panel" id="audioPanel" aria-hidden="true">
    <div class="audio-label">Background music</div>
    <input id="volRange" type="range" min="0" max="1" step="0.01" value="0.16" />
    <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
      <button id="volDown" style="padding:8px;border-radius:8px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.04);color:var(--muted);cursor:pointer">-</button>
      <div id="volValue" style="color:var(--muted);font-weight:600">16%</div>
      <button id="volUp" style="padding:8px;border-radius:8px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.04);color:var(--muted);cursor:pointer">+</button>
    </div>
    <div style="font-size:12px;color:var(--muted);margin-top:6px">Click anywhere to enable audio (autoplay blocked until user gesture).</div>
  </div>
</div>

<!-- custom right-side UI (dots only, no scroll bar) -->
<div class="right-ui" aria-hidden>
  <div class="dot" data-target="home" title="Home"></div>
  <div class="dot" data-target="portfolio" title="Portfolio"></div>
  <div class="dot" data-target="contact" title="Contact"></div>
</div>

<!-- cursor trail container -->
<div class="cursor-trail" id="cursorTrail"></div>

<main>
  <section id="home">
    <div class="container">
      <div class="hero reveal">
        <h1>Litecor â€” Editor & Visual Storyteller</h1>
        <p class="muted">Crafting clean rhythm, punchy pacing, and audience-focused edits. Longform, short-form, and clipping samples below.</p>

        <div class="card-zone" id="cardZone">
          <div class="card-shadow" id="cardShadow" style="opacity:0.9"></div>

          <!-- larger invisible interact area that drives the card parallax -->
          <div class="card-interact" id="cardInteract" aria-hidden>
            <div class="center-card" id="centerCard" role="main" aria-label="Litecor main card" tabindex="0">
              <h2>Welcome to Litecor's Space</h2>
              <p>Something new is taking shape â€” available for editing work.</p>
              <div class="muted" style="margin-top:12px;font-weight:600" id="nameLabel">Litecor</div>
              <!-- timeline scrub visual that appears briefly for card click -->
              <div class="timeline-scrub" id="timelineScrub"><div class="timeline-bar" id="timelineBar"></div></div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>

  <section id="portfolio">
    <div class="container">
      <h2 class="reveal">Portfolio</h2>
      <div class="grid" style="margin-top:18px">
        <div class="vid-card reveal">
          <!-- bigger embed -->
          <iframe src="https://www.youtube.com/embed/T4LQeFQnjWU" title="Longform sample" loading="lazy" allowfullscreen></iframe>
        </div>
        <div class="vid-card reveal">
          <iframe src="https://www.youtube.com/embed/759NWZ98wFE" title="Clipping sample" loading="lazy" allowfullscreen></iframe>
        </div>
      </div>
    </div>
  </section>

  <section id="contact">
    <div class="container">
      <h2 class="reveal">Contact</h2>

      <form class="reveal" id="contactForm" action="https://formspree.io/f/meorknln" method="POST" onsubmit="handleForm(event)">
        <div class="input-row"><label for="name">Name</label><input id="name" name="name" placeholder="Your full name" required /></div>
        <div class="input-row"><label for="email">Email</label><input id="email" name="email" type="email" placeholder="your@email.com" required /></div>
        <div class="input-row"><label for="message">Message</label><textarea id="message" name="message" rows="5" placeholder="Tell Litecor what you need" required></textarea></div>
        <button type="submit" id="submitBtn">Send message</button>
        <div style="margin-top:8px;color:var(--muted);font-size:0.92rem">Or email directly at <strong style="color:var(--accent1)">hello@litecor.example</strong> (placeholder)</div>
      </form>
    </div>
  </section>
</main>

<!-- background music (placeholder) -->
<audio id="bgMusic" src="placeholder.mp3" loop preload="none"></audio>

<!-- bottom message -->
<div class="bottom-note" id="bottomNote"></div>

<script>
/* Utilities */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
function lerp(a,b,t){ return a + (b-a) * t }

/* Elements */
const topNavLinks = $$('#topNav a');
const dots = $$('.right-ui .dot');
const sections = ['home','portfolio','contact'].map(id => document.getElementById(id));
const centerCard = $('#centerCard');
const cardInteract = $('#cardInteract');
const cardShadow = $('#cardShadow');
const cursorTrail = $('#cursorTrail');
const bottomNote = $('#bottomNote');
const bgMusic = $('#bgMusic');
const timelineScrub = $('#timelineScrub');
const timelineBar = $('#timelineBar');
const nameLabel = $('#nameLabel');

const audioBtn = $('#audioBtn');
const audioPanel = $('#audioPanel');
const volRange = $('#volRange');
const volValue = $('#volValue');
const volDown = $('#volDown');
const volUp = $('#volUp');

/* Smooth scroll helper */
function smoothScrollTo(el, duration = 700){
  const startY = window.scrollY || window.pageYOffset;
  const rect = el.getBoundingClientRect();
  const targetY = startY + rect.top;
  const start = performance.now();
  function ease(t){ return 1 - Math.pow(1 - t, 3); }
  function step(now){
    const t = Math.min(1, (now - start) / duration);
    window.scrollTo(0, Math.round(startY + (targetY - startY) * ease(t)));
    if(t < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

/* Nav click -> smooth scroll */
topNavLinks.forEach(a => {
  a.addEventListener('click', e => {
    e.preventDefault();
    const target = document.getElementById(a.dataset.target);
    if(target) smoothScrollTo(target, 700);
  });
});

/* Right dots click */
dots.forEach(d => {
  d.addEventListener('click', () => {
    const t = document.getElementById(d.dataset.target);
    if(t) smoothScrollTo(t, 700);
  });
});

/* Update active dot on scroll (throttled) */
function throttle(fn, wait){ let last=0; return (...args)=>{ const now=Date.now(); if(now - last > wait){ last = now; fn(...args); } } }
function updateActive(){
  sections.forEach((s,i) => {
    const top = s.offsetTop;
    const bottom = top + s.offsetHeight;
    if(window.scrollY >= top - 80 && window.scrollY < bottom - 80){
      dots.forEach(x => x.classList.remove('active'));
      dots[i].classList.add('active');
    }
  });
}
window.addEventListener('scroll', throttle(updateActive, 80));
updateActive();

/* IntersectionObserver reveal */
const io = new IntersectionObserver((entries)=>{
  entries.forEach(en => {
    if(en.isIntersecting){ en.target.classList.add('in'); io.unobserve(en.target); }
  });
},{threshold:0.12});
document.querySelectorAll('.reveal').forEach(el => io.observe(el));

/* Card parallax (same behavior) */
let anim = {rx:0,ry:0,tx:0,ty:0,scale:1};
let zone = {rx:0,ry:0,tx:0,ty:0,scale:1};
const maxTilt = 12;
cardInteract.addEventListener('mousemove', (e) => {
  const r = centerCard.getBoundingClientRect();
  const cx = r.left + r.width/2;
  const cy = r.top + r.height/2;
  const dx = (e.clientX - cx) / (r.width/2);
  const dy = (e.clientY - cy) / (r.height/2);
  const sx = Math.sign(dx) * Math.pow(Math.abs(dx), 1.4);
  const sy = Math.sign(dy) * Math.pow(Math.abs(dy), 1.4);
  zone.ry = Math.max(-maxTilt, Math.min(maxTilt, sx * maxTilt));
  zone.rx = Math.max(-maxTilt, Math.min(maxTilt, -sy * maxTilt));
  zone.tx = sx * 18; zone.ty = sy * 12; zone.scale = 1.04;
  const sX = -sx * 22; const sY = -sy * 12;
  cardShadow.style.transform = `translate3d(${sX}px, ${sY}px, 0)`;
  cardShadow.style.opacity = '0.96';
  centerCard.classList.add('hover');
});
cardInteract.addEventListener('mouseleave', ()=>{
  zone = {rx:0,ry:0,tx:0,ty:0,scale:1};
  cardShadow.style.opacity = '0.72';
  centerCard.classList.remove('hover');
});
(function animateCard(){
  const r = 0.12;
  anim.rx = lerp(anim.rx, zone.rx, r);
  anim.ry = lerp(anim.ry, zone.ry, r);
  anim.tx = lerp(anim.tx, zone.tx, r);
  anim.ty = lerp(anim.ty, zone.ty, r);
  anim.scale = lerp(anim.scale, zone.scale, r);
  centerCard.style.transform = `perspective(900px) translate3d(${anim.tx}px, ${anim.ty}px, 0) rotateX(${anim.rx}deg) rotateY(${anim.ry}deg) scale(${anim.scale})`;
  requestAnimationFrame(animateCard);
})();

/* Cursor trail (unchanged) */
const trailCount = 10;
const trail = [];
for(let i=0;i<trailCount;i++){
  const d = document.createElement('div');
  d.style.position = 'fixed';
  d.style.width = `${6 - i*0.35}px`;
  d.style.height = d.style.width;
  d.style.borderRadius = '999px';
  d.style.background = 'rgba(255,136,0,0.9)';
  d.style.pointerEvents = 'none';
  d.style.mixBlendMode = 'screen';
  d.style.transform = 'translate3d(-9999px,-9999px,0)';
  d.style.opacity = String(1 - i*0.07);
  d.style.transition = 'transform .08s linear, opacity .12s linear';
  cursorTrail.appendChild(d);
  trail.push({el:d,x:-9999,y:-9999});
}
let mx = -9999, my = -9999;
window.addEventListener('mousemove', (e)=>{ mx = e.clientX; my = e.clientY; });
(function trailLoop(){
  let x = mx, y = my;
  for(let i=0;i<trail.length;i++){
    const p = trail[i];
    p.x = lerp(p.x, x, 0.36 - i*0.02);
    p.y = lerp(p.y, y, 0.36 - i*0.02);
    p.el.style.transform = `translate3d(${Math.round(p.x -  (parseFloat(p.el.style.width)/2))}px, ${Math.round(p.y - (parseFloat(p.el.style.height)/2))}px, 0)`;
    x = p.x; y = p.y;
  }
  requestAnimationFrame(trailLoop);
})();

/* Easter egg: ripple smaller, emoji spawn at click point, timeline reaches 100%, cooldown */
let easterActive = false;
const TIMELINE_DURATION = 1200; // ms (slower)
const TIMELINE_COOLDOWN = TIMELINE_DURATION + 300; // cooldown til re-enable

centerCard.addEventListener('click', (ev) => {
  if(easterActive) return;
  easterActive = true;

  // ripple at click point (smaller scale)
  const rx = ev.clientX, ry = ev.clientY;
  const ripple = document.createElement('div');
  ripple.className = 'ripple';
  ripple.style.left = rx + 'px';
  ripple.style.top = ry + 'px';
  ripple.style.width = '8px';
  ripple.style.height = '8px';
  ripple.style.background = 'radial-gradient(circle, rgba(0,188,212,0.28), rgba(106,0,255,0.14))';
  ripple.style.transition = 'transform 650ms cubic-bezier(.2,.9,.2,1), opacity 650ms';
  document.body.appendChild(ripple);
  requestAnimationFrame(()=> { ripple.style.transform = 'translate(-50%,-50%) scale(40)'; ripple.style.opacity = '0'; });
  setTimeout(()=> { try{ document.body.removeChild(ripple); }catch(e){} }, 760);

  // spawn emoji at click location
  spawnEmojiAt(ev.clientX, ev.clientY);

  // show timeline and reach 100%
  timelineScrub.style.display = 'block';
  timelineBar.style.width = '0%';
  setTimeout(()=> timelineBar.style.width = '100%', 40);

  setTimeout(()=> {
    timelineBar.style.width = '0%';
    setTimeout(()=> { timelineScrub.style.display = 'none'; }, 220);
  }, TIMELINE_DURATION);

  // cooldown
  setTimeout(()=> { easterActive = false; }, TIMELINE_COOLDOWN);
});

function spawnEmojiAt(x, y){
  const el = document.createElement('div');
  el.style.position = 'fixed';
  el.style.left = x + 'px';
  el.style.top = y + 'px';
  el.style.transform = 'translate(-50%,-50%)';
  el.style.zIndex = 96;
  el.style.pointerEvents = 'none';
  el.style.fontSize = '18px';
  const emojis = ['âœ‚ï¸','â–¶ï¸','â±ï¸','âœ¨','ðŸ”','ðŸŽšï¸'];
  el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
  el.style.opacity = '0';
  document.body.appendChild(el);
  requestAnimationFrame(()=> {
    el.style.transition = 'transform 900ms cubic-bezier(.2,.9,.2,1), opacity 900ms';
    el.style.transform = 'translate(-50%,-120%) scale(1.1)';
    el.style.opacity = '1';
  });
  setTimeout(()=> {
    el.style.opacity = '0';
    el.style.transform = 'translate(-50%,-200%) scale(.9)';
  }, 900);
  setTimeout(()=> { try{ document.body.removeChild(el); }catch(e){} }, 1400);
}

/* Background 3-click => "that's not a cut" */
let bgClicks = 0, bgTimer = null;
document.addEventListener('click', (e)=>{
  if(e.target.closest('nav') || e.target.closest('.center-card') || e.target.closest('.logo-vid') || e.target.closest('a')) return;
  bgClicks++;
  if(bgTimer) clearTimeout(bgTimer);
  bgTimer = setTimeout(()=> bgClicks = 0, 700);
  if(bgClicks >= 3){ bgClicks = 0; showBottomMessage("that's not a cut", 2000); }
});

/* name 5-clicks => "Frame 67" */
let nameBtnClicks = 0, nameBtnTimer = null;
nameLabel && nameLabel.addEventListener('click', ()=>{
  nameBtnClicks++;
  if(nameBtnTimer) clearTimeout(nameBtnTimer);
  nameBtnTimer = setTimeout(()=> nameBtnClicks = 0, 1200);
  if(nameBtnClicks >= 5){ nameBtnClicks = 0; showBottomMessage('Frame 67', 2000); }
});

/* bottom helper */
let bottomTimer = null;
function showBottomMessage(msg, dur=2000){
  bottomNote.textContent = msg;
  bottomNote.style.opacity = '1'; bottomNote.style.transform = 'translateX(-50%) translateY(0)';
  clearTimeout(bottomTimer);
  bottomTimer = setTimeout(()=>{ bottomNote.style.opacity = '0'; bottomNote.style.transform = 'translateX(-50%) translateY(12px)'; }, dur);
}

/* contact form handler */
async function handleForm(e){
  e.preventDefault();
  const f = e.target;
  const btn = f.querySelector('button');
  btn.disabled = true;
  btn.style.transform = 'scale(.98)';
  try{
    const res = await fetch(f.action, {method:'POST', body:new FormData(f), headers:{'Accept':'application/json'}});
    if(res.ok){ showBottomMessage('Message sent â€” thanks!', 2000); f.reset(); }
    else { showBottomMessage('Failed to send. Try again.', 2000); }
  } catch(err){ showBottomMessage('Network error',2000); }
  btn.disabled = false;
  setTimeout(()=> btn.style.transform = '', 160);
}

/* music: play only after first user gesture */
let musicAllowed = false;
function enableMusicOnce(){
  if(musicAllowed) return;
  musicAllowed = true;
  try{ bgMusic.volume = parseFloat(volRange.value || 0.16); bgMusic.play().catch(()=>{}); }catch(e){}
  document.removeEventListener('click', enableMusicOnce);
}
document.addEventListener('click', enableMusicOnce, {once:true});

/* Audio controls wiring + visual fill for range so ends map correctly */
function updateRangeBackground(input){
  const v = Math.max(0, Math.min(1, parseFloat(input.value)));
  const pct = Math.round(v * 100);
  // use a CSS linear-gradient to fill track fully
  input.style.background = `linear-gradient(90deg, var(--accent1) ${pct}%, rgba(255,255,255,0.06) ${pct}%)`;
}
audioBtn.addEventListener('click', (e)=>{
  const opened = audioPanel.classList.toggle('show');
  audioBtn.setAttribute('aria-expanded', opened ? 'true' : 'false');
});
/* auto-close when pointer leaves the combined audio area (btn + panel) */
let audioCloseTimer = null;
const audioArea = [audioBtn, audioPanel];
audioArea.forEach(el => {
  el.addEventListener('mouseenter', ()=> { clearTimeout(audioCloseTimer); });
  el.addEventListener('mouseleave', ()=> {
    audioCloseTimer = setTimeout(()=> {
      audioPanel.classList.remove('show');
      audioBtn.setAttribute('aria-expanded','false');
    }, 360);
  });
});

volRange.addEventListener('input', (e)=>{
  const v = parseFloat(e.target.value);
  bgMusic.volume = v;
  volValue.textContent = Math.round(v*100) + '%';
  updateRangeBackground(volRange);
});
volDown.addEventListener('click', ()=> {
  let v = Math.max(0, parseFloat(volRange.value) - 0.05);
  volRange.value = v.toFixed(2);
  volRange.dispatchEvent(new Event('input'));
});
volUp.addEventListener('click', ()=> {
  let v = Math.min(1, parseFloat(volRange.value) + 0.05);
  volRange.value = v.toFixed(2);
  volRange.dispatchEvent(new Event('input'));
});
/* set initial UI */
volRange.value = 0.16;
volValue.textContent = Math.round(parseFloat(volRange.value)*100) + '%';
bgMusic.volume = parseFloat(volRange.value);
updateRangeBackground(volRange);

/* initial reveal on load */
window.addEventListener('load', ()=> {
  document.querySelectorAll('.reveal').forEach((el,i)=> setTimeout(()=> el.classList.add('in'), 120 + i*60));
  updateActive();
});
window.addEventListener('resize', throttle(()=> updateActive(), 120));

/* accessibility escape */
document.addEventListener('keydown', (e) => {
  if(e.key === 'Escape'){ dots.forEach(d => d.classList.remove('active')); updateActive(); }
});
</script>
</body>
</html>
